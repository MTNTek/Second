"use strict";(()=>{var e={};e.id=38,e.ids=[38],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},8678:e=>{e.exports=import("pg")},5633:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{originalPathname:()=>y,patchFetch:()=>p,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var r=s(9303),n=s(8716),i=s(670),u=s(181),o=e([u]);u=(o.then?(await o)():o)[0];let c=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/applications/[id]/route",pathname:"/api/admin/applications/[id]",filename:"route",bundlePath:"app/api/admin/applications/[id]/route"},resolvedPagePath:"C:\\dev\\Second\\app\\api\\admin\\applications\\[id]\\route.ts",nextConfigOutput:"standalone",userland:u}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:m}=c,y="/api/admin/applications/[id]/route";function p(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}a()}catch(e){a(e)}})},181:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{PUT:()=>c});var r=s(7070),n=s(8678),i=s(1482),u=s.n(i),o=e([n]);let d=new(n=(o.then?(await o)():o)[0]).Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}});async function p(e){try{let t=u().verify(e,process.env.JWT_SECRET||"your-secret-key");if("admin"!==t.role)return null;return t}catch(e){return null}}async function c(e,{params:t}){try{let s=e.headers.get("authorization");if(!s||!s.startsWith("Bearer "))return r.NextResponse.json({success:!1,message:"Authorization header required"},{status:401});let a=s.substring(7);if(!await p(a))return r.NextResponse.json({success:!1,message:"Admin access required"},{status:403});let{status:n}=await e.json(),i=t.id;if(!n||!["pending","in_progress","approved","rejected","completed"].includes(n))return r.NextResponse.json({success:!1,message:"Invalid status"},{status:400});let u=await d.connect();try{let e=`
        UPDATE applications 
        SET status = $1, updated_at = NOW()
        WHERE id = $2
        RETURNING *
      `,t=await u.query(e,[n,i]);if(0===t.rows.length)return r.NextResponse.json({success:!1,message:"Application not found"},{status:404});let s=`
        SELECT 
          a.*,
          u.name as user_name,
          u.email as user_email
        FROM applications a
        JOIN users u ON a.user_id = u.id
        WHERE a.id = $1
      `,a=(await u.query(s,[i])).rows[0];return r.NextResponse.json({success:!0,data:{id:a.id,userId:a.user_id,userName:a.user_name,userEmail:a.user_email,type:a.type,serviceName:a.service_name,status:a.status,amount:a.amount,currency:a.currency,createdAt:a.created_at,updatedAt:a.updated_at},message:`Application status updated to ${n}`})}finally{u.release()}}catch(e){return console.error("Error updating application:",e),r.NextResponse.json({success:!1,message:"Internal server error"},{status:500})}}a()}catch(e){a(e)}})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[276,972,482],()=>s(5633));module.exports=a})();