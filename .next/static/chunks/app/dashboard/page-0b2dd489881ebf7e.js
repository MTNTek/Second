(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{3394:function(e,s,t){Promise.resolve().then(t.bind(t,219))},219:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return n}});var a=t(7437),l=t(2265),r=t(1245);function i(){let{user:e,loading:s}=(0,r.a)(),[t,i]=(0,l.useState)("overview"),[n,c]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),[m,x]=(0,l.useState)({totalApplications:0,pendingApplications:0,approvedApplications:0,totalSpent:0}),[h,u]=(0,l.useState)(!0),[p,g]=(0,l.useState)(null);(0,l.useEffect)(()=>{e&&j()},[e]);let j=async()=>{u(!0),g(null);try{c([]),o([]),x({totalApplications:0,pendingApplications:0,approvedApplications:0,totalSpent:0})}catch(e){console.error("Error fetching user data:",e),g("Failed to load dashboard data. Please try again.")}finally{u(!1)}};return s||h?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",e.name]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your applications and profile"})]}),(0,a.jsxs)("button",{onClick:j,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",name:"Overview",icon:"\uD83D\uDCCA"},{id:"applications",name:"Applications",icon:"\uD83D\uDCCB"},{id:"payments",name:"Payments",icon:"\uD83D\uDCB3"},{id:"profile",name:"Profile",icon:"\uD83D\uDC64"}].map(e=>(0,a.jsxs)("button",{onClick:()=>i(e.id),className:"".concat(t===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm flex items-center"),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id))})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[p&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,a.jsx)("p",{children:p})})]})})}),"overview"===t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCCB"}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Applications"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:m.totalApplications})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"⏳"}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:m.pendingApplications})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"✅"}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:m.approvedApplications})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCB0"}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Spent"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AED";return new Intl.NumberFormat("en-AE",{style:"currency",currency:s}).format(e)}(m.totalSpent)})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Welcome to Your Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Get started by applying for our services. Once you submit applications, they'll appear here for tracking."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"✈️"}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Travel Services"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Book flights, hotels, and travel packages"})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDEC2"}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Visa Services"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Apply for various visa types"})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCBC"}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Work Permits"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Get assistance with work permits"})]})]})]})]}),"applications"===t&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Your Applications"}),(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCCB"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No applications yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Start by applying for our services to see them here."})]})]}),"payments"===t&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Payment History"}),(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCB3"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No payments yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Your payment history will appear here once you make transactions."})]})]}),"profile"===t&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Profile Information"})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:e.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:e.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:e.role})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Member Since"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:e.createdAt?new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Recently joined"})]})]})})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Please log in to access your dashboard."}),(0,a.jsx)("button",{onClick:()=>window.location.href="/",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Go to Home"})]})})}function n(){return(0,a.jsx)(i,{})}},1245:function(e,s,t){"use strict";t.d(s,{AuthProvider:function(){return i},a:function(){return n}});var a=t(7437),l=t(2265);let r=(0,l.createContext)(void 0);function i(e){let{children:s}=e,[t,i]=(0,l.useState)(null),[n,c]=(0,l.useState)(null),[d,o]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=localStorage.getItem("token");e?(c(e),m(e)):o(!1)},[]);let m=async e=>{try{let s=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let{user:e}=await s.json();i(e)}else u()}catch(e){console.error("Failed to fetch user:",e),u()}finally{o(!1)}},x=async(e,s)=>{try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s})}),a=await t.json();if(t.ok)return c(a.token),i(a.user),localStorage.setItem("token",a.token),a;throw Error(a.error||"Login failed")}catch(e){throw console.error("Login error:",e),e}},h=async e=>{try{let s=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await s.json();if(s.ok)return t;throw Error(t.error||"Registration failed")}catch(e){throw console.error("Registration error:",e),e}},u=()=>{c(null),i(null),localStorage.removeItem("token")};return(0,a.jsx)(r.Provider,{value:{user:t,token:n,loading:d,login:x,register:h,logout:u,isAuthenticated:!!t},children:s})}function n(){let e=(0,l.useContext)(r);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[216,744],function(){return e(e.s=3394)}),_N_E=e.O()}]);